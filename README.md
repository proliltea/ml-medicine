# ml-medicine
ğŸš€ Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹ (Inference)

Ğ”Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼ Python 3.8+ Ğ¸ Ğ±Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ¸: pandas, joblib, catboost, xgboost.

1. ğŸ§¬ Pancreatic Cancer Model (pancreatic_cancer_model.joblib)
   
ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ»Ñ Ğ¿Ñ€ĞµĞ´ÑĞºĞ°Ğ·Ğ°Ğ½Ğ¸Ñ Ñ€Ğ¸ÑĞºĞ° Ñ€Ğ°ĞºĞ° Ğ¿Ğ¾Ğ´Ğ¶ĞµĞ»ÑƒĞ´Ğ¾Ñ‡Ğ½Ğ¾Ğ¹ Ğ¶ĞµĞ»ĞµĞ·Ñ‹ (Binary Classification).

ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼: CatBoost.

Ğ’Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ (Raw Input):

ĞŸÑ€Ğ¸Ğ·Ğ½Ğ°Ğº	ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ

age	Ğ’Ğ¾Ğ·Ñ€Ğ°ÑÑ‚ (Ğ»ĞµÑ‚)

sex	ĞŸĞ¾Ğ» ('M' Ğ¸Ğ»Ğ¸ 'F')

plasma_CA19_9	ĞĞ½Ğ°Ğ»Ğ¸Ğ· ĞºÑ€Ğ¾Ğ²Ğ¸ (ĞµĞ´/Ğ¼Ğ»). ĞœĞ¾Ğ¶Ğ½Ğ¾ NaN.

creatinine	ĞšÑ€ĞµĞ°Ñ‚Ğ¸Ğ½Ğ¸Ğ½ Ğ² Ğ¼Ğ¾Ñ‡Ğµ (Ğ¼Ğ³/Ğ´Ğ»)

LYVE1, REG1B, TFF1	Ğ‘Ğ¸Ğ¾Ğ¼Ğ°Ñ€ĞºĞµÑ€Ñ‹ Ğ¼Ğ¾Ñ‡Ğ¸ (Ğ½Ğ³/Ğ¼Ğ»)

âš™ï¸ ĞŸÑ€ĞµĞ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¸Ğ½Ğ³ (ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾!)

ĞŸĞµÑ€ĞµĞ´ Ğ¿Ğ¾Ğ´Ğ°Ñ‡ĞµĞ¹ Ğ² model.predict() Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ÑĞ¸Ğ½Ñ‚ĞµÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¿Ñ€Ğ¸Ğ·Ğ½Ğ°ĞºĞ¸:

code

Python

# df - DataFrame Ñ ÑÑ‹Ñ€Ñ‹Ğ¼Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸

# 1. ĞœĞ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³ Ğ¿Ğ¾Ğ»Ğ°

df['sex'] = df['sex'].map({'M': 0, 'F': 1})

# 2. ĞĞ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ½Ğ° ĞºÑ€ĞµĞ°Ñ‚Ğ¸Ğ½Ğ¸Ğ½

df['LYVE1_ratio'] = df['LYVE1'] / df['creatinine']

df['REG1B_ratio'] = df['REG1B'] / df['creatinine']

df['TFF1_ratio']  = df['TFF1']  / df['creatinine']

# 3. Ğ’Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ğ·Ğ½Ğ°ĞºĞ¾Ğ² (Interactions)

df['LYVE1_x_REG1B'] = df['LYVE1_ratio'] * df['REG1B_ratio']

df['REG1B_x_TFF1']  = df['REG1B_ratio'] * df['TFF1_ratio']

# ĞŸĞ¾Ñ€ÑĞ´Ğ¾Ğº ĞºĞ¾Ğ»Ğ¾Ğ½Ğ¾Ğº Ğ²Ğ°Ğ¶ĞµĞ½ Ğ´Ğ»Ñ CatBoost!
cols = ['age', 'sex', 'plasma_CA19_9', 'creatinine', 'LYVE1', 'REG1B', 'TFF1', 
        'LYVE1_ratio', 'REG1B_ratio', 'TFF1_ratio', 'LYVE1_x_REG1B', 'REG1B_x_TFF1']
        
prediction = model.predict_proba(df[cols])[:, 1]

2. â¤ï¸ Cardiovascular Disease Model (cardio_model.joblib)
3. 
ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ¾Ñ†ĞµĞ½ĞºĞ¸ Ñ€Ğ¸ÑĞºĞ° ÑĞµÑ€Ğ´ĞµÑ‡Ğ½Ğ¾-ÑĞ¾ÑÑƒĞ´Ğ¸ÑÑ‚Ñ‹Ñ… Ğ·Ğ°Ğ±Ğ¾Ğ»ĞµĞ²Ğ°Ğ½Ğ¸Ğ¹.

ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼: XGBoost.

Ğ’Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ (Raw Input):

ĞŸÑ€Ğ¸Ğ·Ğ½Ğ°Ğº	ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ	Ğ’Ğ°Ğ¶Ğ½Ğ¾

age	Ğ’Ğ¾Ğ·Ñ€Ğ°ÑÑ‚	Ğ’ Ğ´Ğ½ÑÑ…! (Ğ›ĞµÑ‚ * 365)

gender	ĞŸĞ¾Ğ»	1 = Ğ–, 2 = Ğœ

height / weight	Ğ Ğ¾ÑÑ‚ (ÑĞ¼) / Ğ’ĞµÑ (ĞºĞ³)	

ap_hi / ap_lo	Ğ”Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ (Ğ²ĞµÑ€Ñ…/Ğ½Ğ¸Ğ·)	

cholesterol	Ğ¥Ğ¾Ğ»ĞµÑÑ‚ĞµÑ€Ğ¸Ğ½	1 (Ğ½Ğ¾Ñ€Ğ¼), 2 (Ğ²Ñ‹Ñˆ), 3 (Ğ²Ñ‹Ñ)

gluc	Ğ“Ğ»ÑĞºĞ¾Ğ·Ğ°	1 (Ğ½Ğ¾Ñ€Ğ¼), 2 (Ğ²Ñ‹Ñˆ), 3 (Ğ²Ñ‹Ñ)

smoke / alco / active	ĞŸÑ€Ğ¸Ğ²Ñ‹Ñ‡ĞºĞ¸	0 (Ğ½ĞµÑ‚) / 1 (Ğ´Ğ°)

âš™ï¸ ĞŸÑ€ĞµĞ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¸Ğ½Ğ³ (ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾!)

ĞĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ğ¿ÑƒĞ»ÑŒÑĞ¾Ğ²Ğ¾Ğµ Ğ´Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ.

code

Python

# df - DataFrame Ñ ÑÑ‹Ñ€Ñ‹Ğ¼Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸

# 1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ğ·Ğ½Ğ°ĞºĞ° ap_diff

df['ap_diff'] = df['ap_hi'] - df['ap_lo']

# 2. Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ»Ğ¸ÑˆĞ½ĞµĞ³Ğ¾ (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ id)

if 'id' in df.columns: df = df.drop(columns=['id'])

# 3. ĞŸÑ€ĞµĞ´ÑĞºĞ°Ğ·Ğ°Ğ½Ğ¸Ğµ (Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ñ‹Ğ¹ Ğ¿Ğ¾Ñ€Ğ¾Ğ³ 0.45 Ğ´Ğ»Ñ Recall)

probs = model.predict_proba(df)[:, 1]

result = (probs > 0.45).astype(int)
